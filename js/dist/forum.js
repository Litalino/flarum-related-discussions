(()=>{var t={n:e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return t.d(s,{a:s}),s},d:(e,s)=>{for(var a in s)t.o(s,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:s[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e);const s=flarum.core.compat["forum/app"];var a=t.n(s);const i=flarum.core.compat["common/extend"],r=flarum.core.compat["forum/components/PostStream"];var l=t.n(r);const n=flarum.core.compat["forum/components/DiscussionPage"];var o=t.n(n);const c=flarum.core.compat["common/helpers/avatar"];var u=t.n(c);const d=flarum.core.compat["common/components/Link"];var p=t.n(d);const f=flarum.core.compat["tags/helpers/tagsLabel"];var v=t.n(f);const b=flarum.core.compat["common/components/Separator"];var h=t.n(b);const N=flarum.core.compat["common/components/Tooltip"];var y=t.n(N);const g=flarum.core.compat["common/helpers/username"];var P=t.n(g);a().initializers.add("litalino/related-discussions",(function(){(0,i.extend)(l().prototype,"oncreate",(function(){var t=this,e=this.attrs.discussion,s=a().forum.attribute("litalino-related-discussions.relatedLimit")||4,i=document.getElementById("listRel");a().store.find("discussions",{page:{limit:s+1},"filter[q]":e.data.attributes.title}).then((function(e){t.relDiscussion=e,m.mount(i,(function(){var e=t.relDiscussion.splice(1,s),i=a().forum.attribute("litalino-related-discussions.showTooltip");return{view:function(){return m("div",{className:"wraprelated"},m("h1",{className:"DiscussionListItem-title related"},m("i",{className:"fas fa-indent relatedTitle"}),a().forum.attribute("litalino-related-discussions.relatedTitle")||a().translator.trans("litalino-related-discussions.forum.reldiscussion")),m("div",{className:"related-discussions",role:"navigation"},e.map((function(t){var e,s,r,l,n=null==(e=t.data)||null==(e=e.attributes)?void 0:e.createdAt.slice(0,10);console.log(t);var o={view:function(e){if(!1!==t.data.attributes.hasBestAnswer&&void 0!==t.data.attributes.hasBestAnswer)return m("span",{classname:"has-best-answer",id:"has-best-answer",title:a().translator.trans("litalino-related-discussions.forum.hasBestAnswer-title")},a().translator.trans("litalino-related-discussions.forum.hasBestAnswer"))}};return m("div",{className:"DiscussionListItem-content Slidable-content read related"},m(p(),{href:a().forum.attribute("baseUrl")+"/u/"+(null==(s=t.user().data)||null==(s=s.attributes)?void 0:s.username)},m(y(),{text:(null==(r=t.user().data)||null==(r=r.attributes)?void 0:r.username)+" "+a().translator.trans("litalino-related-discussions.forum.avatarTooltip")+" "+n},u()(t.user(),{title:null==(l=t.user().data)||null==(l=l.attributes)?void 0:l.username,className:"relatedAvatar"}))),!0===i?m(y(),{className:"tooltip-related",text:t.firstPost().contentHtml().replace(/<\/?[^>]+(>|$)/g,"").substr(0,200)+"..."},m(p(),{className:"DiscussionListItem-main related",title:t.title(),href:a().route.discussion(t)},m("h3",{className:"DiscussionListItem-title related"},t.title()," ",m(o)),m("ul",{className:"DiscussionListItem-info related"},m("li",{className:"item-terminalPost"},m("span",null,m("i",{"aria-hidden":"true",className:"icon fas fa-reply "})," ",m("span",{className:"username"},P()(t.lastPostedUser())),m("span",{className:"replied-on"},a().translator.trans("litalino-related-discussions.forum.repliedOn")," "),m("time",{dateTime:t.data.attributes.lastPostedAt},a().translator.trans("litalino-related-discussions.forum.postedOn")," ",t.data.attributes.lastPostedAt.slice(0,10))))))):m(p(),{className:"DiscussionListItem-main related",title:t.title(),href:a().route.discussion(t)},m("h3",{className:"DiscussionListItem-title related"},t.title()," ",m(o)),m("ul",{className:"DiscussionListItem-info related"},m("li",{className:"item-terminalPost"},m("span",null,m("i",{"aria-hidden":"true",className:"icon fas fa-reply "})," ",m("span",{className:"username"},P()(t.lastPostedUser())),m("span",{className:"replied-on"},a().translator.trans("litalino-related-discussions.forum.repliedOn")," "),m("time",{dateTime:t.data.attributes.lastPostedAt},a().translator.trans("litalino-related-discussions.forum.postedOn")," ",t.data.attributes.lastPostedAt.slice(0,10)))))),m("span",{className:"DiscussionListItem-count related"},v()(t.tags(),{link:!0,className:"related-tag"})))}))),m("div",{className:"separator-related"},m(h(),null)))}}}))}))})),(0,i.extend)(l().prototype,"view",(function(t){if(!1===a().forum.attribute("litalino-related-discussions.enable.DiscussionPageLayout")&&t.children&&t.children.splice){var e=m("div",{key:"litalino-relatedDisc",className:"relatedList",id:"listRel"});t.children.splice(1,0,e)}})),(0,i.extend)(o().prototype,"view",(function(t){if(!0===a().forum.attribute("litalino-related-discussions.enable.DiscussionPageLayout")&&t.children&&t.children.splice){var e=m("div",{key:"litalino-relatedDisc-DiscussionPage",className:"container related",id:"listRel"});t.children.splice(2,0,e)}}))}))})(),module.exports=e})();
//# sourceMappingURL=forum.js.map